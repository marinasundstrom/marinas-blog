<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    
    <title>Marina Sundström</title>
    
    <meta name="description" content="Personal blog of Marina Sundström."/>
    <meta name="keywords" content="Blog, Personal, Software Development"/>

    <base href="/"/>
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet"/>
    <link href="css/app.css" rel="stylesheet"/>
    <link href="PersonalSite.styles.css" rel="stylesheet"/>

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon.png"/>
    <link rel="manifest" href="/site.webmanifest"/>
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"/>
    <meta name="msapplication-TileColor" content="#da532c"/>
    <meta name="theme-color" content="#ffffff"/>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/vs.min.css"/>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.7.0/highlightjs-line-numbers.min.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&amp;display=swap" rel="stylesheet"/>
    <link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,200;1,300;1,400;1,600;1,700;1,900&amp;display=swap" rel="stylesheet"/>

    <script src="/js/scripts.js"></script>

    <style>
        .bd-placeholder-img {
          font-size: 1.125rem;
          text-anchor: middle;
          -webkit-user-select: none;
          -moz-user-select: none;
          user-select: none;
        }
  
        @media (min-width: 768px) {
          .bd-placeholder-img-lg {
            font-size: 3.5rem;
          }
        }
      </style>
    

<!-- %%-PRERENDERING-HEADOUTLET-BEGIN-%% -->
<title>Blazor Web Apps in ASP.NET Core 8 - Marina Sundström</title>
<!-- %%-PRERENDERING-HEADOUTLET-END-%% -->
<script src="data:text/javascript;base64,KGZ1bmN0aW9uKG4sdCxpKXtmb3IodmFyIGY9bi5jcmVhdGVOb2RlSXRlcmF0b3IobiwxMjgpLHIsZSx1O2YubmV4dE5vZGUoKTspaWYocj1mLnJlZmVyZW5jZU5vZGUsdC50ZXN0KHIudGV4dENvbnRlbnQudHJpbSgpKSl7d2hpbGUoaT1yLm5leHRTaWJsaW5nKWlmKGU9aS50ZXh0Q29udGVudC50cmltKCksaS5yZW1vdmUoKSx0LnRlc3QoZSkpYnJlYWs7ci5yZW1vdmUoKTticmVha311PUFycmF5LmZyb20obi5xdWVyeVNlbGVjdG9yQWxsKCJzY3JpcHQiKSkucG9wKCk7dSYmdS5yZW1vdmUoKX0pKGRvY3VtZW50LC9eJSUtUFJFUkVOREVSSU5HLUhFQURPVVRMRVQtKEJFR0lOfEVORCktJSUkLyk7"></script></head>

<body>
    <div id="app" class="d-flex h-100">
        <svg class="loading-progress">
            <circle r="40%" cx="50%" cy="50%"></circle>
            <circle r="40%" cx="50%" cy="50%"></circle>
        </svg>
        <div class="loading-progress-text"></div>
    
<!-- %%-PRERENDERING-BEGIN-%% -->
<div style="opacity: 0; position: fixed; z-index: -1; top: 0; left: 0; bottom: 0; right: 0;">
    <div class="container d-flex w-100 h-100 mx-auto flex-column" style="padding-top: 110px !important;"><header><div><nav class="navbar navbar-expand-lg bg-brand navbar-dark fixed-top px-3"><div class="container"><a href="" class="navbar-brand mr-auto mr-lg-0"><img src="/images/profile.jpeg" alt="Profile Image" class="rounded-circle profile" style="margin-right: 10px; height: 32px; font-weight: 700">
        Marina Sundström</a>
    <button class="navbar-toggler p-0 border-0" type="button" data-toggle="offcanvas"><span class="navbar-toggler-icon"></span></button>

    <div class="navbar-collapse offcanvas-collapse " id="navbarsExampleDefault"><ul class="navbar-nav mr-auto"><li class="nav-item active"><a href="" class="nav-link">Home</a></li>
            <li class="nav-item active"><a href="/#who-am-i" class="nav-link">About me</a></li>
            <li class="nav-item"><a href="articles" class="nav-link active">Articles</a></li>
            <li class="nav-item"><a href="resume" class="nav-link">Resumé</a></li>
            <li class="nav-item"><a href="portfolio" class="nav-link">Portfolio</a></li></ul>
        <ol class="navbar-nav flex-row flex-wrap ms-md-auto list-inline list-unstyled" style="margin: 0;"><li class="nav-item list-inline-item"><a class="nav-link menu-link me-0 py-2 text-decoration-none text-uppercase" href="https://github.com/marinasundstrom" title="GitHub" target="_blank"><i class="fab fa-2x fa-github"></i></a></li>

            <li class="nav-item list-inline-item"><a class="nav-link menu-link me-0 py-2 text-decoration-none text-uppercase" href="https://www.youtube.com/channel/UCVdav9wE4kmtiEuk1_vG2_g" target="_blank"><i class="fab fa-2x fa-youtube"></i></a></li>

            <li class="nav-item list-inline-item"><a class="nav-link menu-link me-0 py-2 text-decoration-none text-uppercase" href="https://twitter.com/marna_li" title="Twitter" target="_blank"><i class="fab fa-2x fa-twitter"></i></a></li>

            <li class="nav-item list-inline-item"><a class="nav-link menu-link me-0 py-2 text-decoration-none text-uppercase" href="https://www.linkedin.com/in/marinasundstrom" title="LinkedIn" target="_blank"><i class="fab fa-2x fa-linkedin"></i></a></li>

            <li class="nav-item vr"></li>

            <li class="nav-item list-inline-item dropdown"><a class="nav-link menu-link me-0 py-2 dropdown-toggle" __internal_preventDefault_onclick __internal_stopPropagation_onclick href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-2x fa-sun"></i></a>
                <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink"><li><a class="dropdown-item" href="#" __internal_preventDefault_onclick><i class="fas fa-2x fa-sun"></i><span class="ms-2 fs-5">•</span></a></li>
                    <li><a class="dropdown-item" href="#" __internal_preventDefault_onclick><i class="fas fa-2x fa-moon"></i></a></li>
                    <li><a class="dropdown-item" href="#" __internal_preventDefault_onclick><i class="fas fa-2x fa-cog"></i></a></li></ul></li></ol></div></div></nav></div></header>

  <main><article class="post outer"><div class="inner container"><header b-76by154q0w><h1 class="post-title" b-76by154q0w>Blazor Web Apps in ASP.NET Core 8</h1><div class="mt-2 mt-md-3" b-76by154q0w><div class="d-flex justify-content-between" b-76by154q0w><span b-76by154q0w><small class="mb-2 text-muted" b-76by154q0w><time datetime="2023-09-02" b-76by154q0w>2 Sep 2023</time> • 
                        6 minutes read

</small><small class="text-muted" b-76by154q0w> • </small><a class="badge rounded-pill tag me-1 mb-1 text-decoration-none" href="/articles/tags/Blazor" b-76by154q0w>Blazor</a><a class="badge rounded-pill tag me-1 mb-1 text-decoration-none" href="/articles/tags/.NET" b-76by154q0w>.NET</a><a class="badge rounded-pill tag me-1 mb-1 text-decoration-none" href="/articles/tags/ASP.NET%20Core" b-76by154q0w>ASP.NET Core</a><a class="badge rounded-pill tag me-1 mb-1 text-decoration-none" href="/articles/tags/Web%20development" b-76by154q0w>Web development</a></span><div b-76by154q0w><h4 class="badge bg-secondary comment-badge m-0"><span class="disqus-comment-count" data-disqus-url="http://127.0.0.1:5050/articles/blazor-web-apps-in-aspnet-core-8">#</span></h4></div></div></div></header></div>

            <div class="mt-4 inner container"><p>Some big exciting stuff is coming to Blazor on the server in ASP.NET Core 8.</p>
<h2 id="background">Background</h2>
<p>In the beginning of time, Web development used to be about the web server receiving a request from a client browser, generating some HTML, and returning it with the response. The result was a static non-interactive page that the browser rendered on screen.</p>
<p>Then JavaScript came along, and added interactivity on the client-side - the ability to make changes to the content of the page based on user input. And with JavaScript you got the ability to make requests to the server, to then dynamically update parts of that static page. The content of the page was not longer tied to just one request.</p>
<p>Following the advancements and increased computing power on client devices, we started making fully dynamic and interactive Single-page applications, so called SPAs - using JavaScript frameworks like Backbone, and later React and Angular. Blazor is a pretty recent addition.</p>
<p>But recently, developers have realized that SPAs are not suitable or even necessary for everything.</p>
<p>Sometimes you just want to generate and serve content very fast and efficiently - an example of this are big e-commerce sites with a lot of load. But at the same time you want to enable interactivity were it is needed.</p>
<p>A recent trend among modern JavaScript Web app frameworks (such as Astro) is to combine server-side rendering and client-side interactivity. Enabling you to choose whether a certain part of the page - a component - should be rendered on the server, or be activated as an interactive component on the client.</p>
<p>This is a major theme for Blazor in ASP.NET Core 8 - to enable these mixed server-side rendering and interactivity scenarios.</p>
<h2 id="unified-blazor-architecture-on-the-server">Unified Blazor architecture - on the server</h2>
<p>The big theme for Blazor in .NET 8 is the unification of Blazor on the server. A great deal of plumbing has been done to add <em>Server-side rendering (SSR)</em>, and to enable interactivity per component with so called <em>Render modes</em>. In essence, this is an improved Blazor Server hosting model, where SSR now is the default.</p>
<p>There are other significant enhancements, such as <em>enhanced navigation</em>, that will make your server-side rendered apps feel as smooth as single-page applications.</p>
<p>This doesn't affect other hosting models, such as standalone Blazor WebAssembly and MAUI Blazor Hybrid. Though they are of course getting all the enhancements to Blazor itself.</p>
<h2 id="server-side-rendering-ssr">Server-side rendering (SSR)</h2>
<p>ASP.NET Core 8 and Blazor Server-side rendering (SSR) fills the remaining gap between ASP.NET Core and Blazor - by making Blazor Server able to serve traditional non-interactive pages, like MVC Razor Pages does, but with Razor components. The twist is that you can make any component interactive if you want to.</p>
<p>To clarify, Blazor is the name of the product in all of its variations - <em>Razor Components</em> is the technology behind it. <em>Razor</em> is the C#/HTML templating syntax, of which there are the MVC/Razor Pages and Blazor flavors.</p>
<p>Previously, Blazor Server had also been reliant on Razor Pages for bootstrapping, but that is no longer necessary since ASP.NET Core now can render Razor components as plain HTML directly at a certain endpoint.</p>
<p>So the way you should think of this new "Blazor Web App" an improvement on the <em>Blazor Server</em> hosting model. The standalone WebAssembly type is still the same, but these improvements do open up for some interesting hybrid scenarios on the server as we will see with render modes.</p>
<h3 id="routing">Routing</h3>
<p>The Blazor router fully integrates and take advantage of ASP.NET Core endpoints in SSR mode.</p>
<p>Then you let ASP.NET Core register the components in the Dependency Injection container.</p>
<pre><code class="language-csharp">builder.Services.AddRazorComponents()
    .AddWebAssemblyComponents()
    .AddServerComponents();
</code></pre>
<p>And then map them to endpoints - with <code>App</code> being the root component:</p>
<pre><code class="language-csharp">app.MapRazorComponents&lt;App&gt;()
    .AddWebAssemblyRenderMode()
    .AddServerRenderMode();
</code></pre>
<p>Given that you have set the router up, you then add the <code>@page</code> as you normally do.</p>
<pre><code class="language-csharp">@page "/my-page"
</code></pre>
<p>Unless the render modes of either the Router component or the page component has been set to Server or WebAssembly, this will be served as a static page. More on render modes below.</p>
<h4 id="using-minimal-api">Using Minimal API</h4>
<p>You can manually map a component to an endpoint, by creating your own Minimal API endpoint that returns a <code>RazorComponentResult</code>.</p>
<pre><code class="language-csharp">app.Map("/mything", () =&gt; new RazorComponentResult&lt;MyPageComponent&gt;());
</code></pre>
<h2 id="render-modes">Render modes</h2>
<p>A Blazor Web App is fundamentally rendered on the server. But as mentioned, you can turn on interactivity per-component in the SSR context. You can also tell a component where it should run: on the server, or on the client using WebAssembly. It all is a seamless experience. And pre-rendering just works out of box.</p>
<pre><code class="language-csharp">@* For being rendered on the server *@
&lt;Counter @rendermode="RenderMode.Server" /&gt;

@* For running in WebAssembly *@
&lt;Counter @rendermode="RenderMode.WebAssembly" /&gt;
</code></pre>
<p>You can also specify the default render mode for a component using these attributes.</p>
<pre><code class="language-csharp">@attribute [RenderModeServer]

@attribute [RenderModeWebAssembly]
</code></pre>
<p>The render mode is then inherited by sub-components. You can apply these attributes to the router, and that would make the entire site interactive. But by default, a project created from a template has no interactivity at root-level.</p>
<p>The WebAssembly render mode does require you to set up a separate project that will contain all the bits (components and services) that will be shipped to the browsers. So although integrated, it are still technically two apps.</p>
<h3 id="auto-render-mode">Auto render mode</h3>
<p>The Auto render mode will prefer WebAssembly, but fall back on Server for interactivity when the WebAssembly files have not yet been downloaded. Once the WebAssembly files have downloaded, the next time you load those components, the component will be running in WebAssembly.</p>
<pre><code class="language-csharp">&lt;Counter @rendermode="RenderMode.Auto" /&gt;
</code></pre>
<h2 id="enhanced-navigation">Enhanced navigation</h2>
<p>Whenever you normally navigate on a new server-side rendered page, the entire DOM is replaced, and the window is redrawn. This sometimes causes flickers that affect the user experience even if the browser tries to mitigate it.</p>
<p>Blazor has got a trick:</p>
<p>Whenever the user navigates to a page inside the application, the navigation gets intercepted, and instead a HTTP request gets sent. Once a response has returned, Blazor figures out the difference between the HTML returned in the response and the one of the current page in the browser, and then applies only the changes to the browser.</p>
<p>This makes your server-side rendered app feel like it is a SPA while it is not. There will be no flickering. You will see that the shell of the application and its menus get preserved.</p>
<h2 id="stream-rendering">Stream rendering</h2>
<p>When you first visit a page you may have to wait for the page to execute some logic, and to then return the fully rendered page - while all you are seeing is a blank screen. It can be quite frustrating even when it is just for a second or two.</p>
<p>Blazor has got yet another trick:</p>
<p>Blazor can render and send you the shell before the page component has been fully initialized. Once that has completed, it just sends the rest of the rendered content, and applies it to the page in the browser.</p>
<p>Just add this attribute to your Page components.</p>
<pre><code class="language-csharp">@attribute [StreamRendering(prerender: true)]
</code></pre>
<p>Stream rendering utilizes HTTP Streaming to send partial content in chunks over the same HTTP Request.</p>
<h2 id="form-binding-in-blazor-ssr">Form binding in Blazor SSR</h2>
<p>In Blazor SSR, you can bind a model to a form using the <code>[SupplyParameterFromForm]</code> attribute - and with some minor adjustments to the form because this page is bound to a HTTP request</p>
<pre><code class="language-csharp">&lt;form method="post" @formname="contact" @onsubmit="AddContact"&gt;
    &lt;div&gt;
        &lt;label for="name"&gt;Name&lt;/label&gt;
        &lt;InputText id="name" @bind-Value="NewContact.Name" /&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;label for="email"&gt;Email&lt;/label&gt;
        &lt;InputText id="email" @bind-Value="NewContact.Email" /&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;InputCheckbox id="send-me-deals" @bind-Value="NewContact.SendMeDeals" /&gt;
        &lt;label for="send-me-deals"&gt;Send me deals&lt;/label&gt;
    &lt;/div&gt;
    &lt;button&gt;Submit&lt;/button&gt;
    &lt;AntiforgeryToken /&gt;
&lt;/form&gt;

@code {
    [SupplyParameterFromForm]
    public Contact NewContact { get; set; } = new();

    public class Contact
    {
        public string Name { get; set; }
        public string Email { get; set; }
        public bool SendMeDeals { get; set; }
    }

    private async Task AddContact()
    {
        // Add contact...
        NewContact = new();
    }
}
</code></pre>
<p>Source: <a href="https://devblogs.microsoft.com/dotnet/asp-net-core-updates-in-dotnet-8-preview-7/">ASP.NET Core updates in .NET 8 Preview 7</a></p>
<p>On a side note: Antiforgery has also been implemented for Minimal APIs. This applies to forms such as this one in Blazor SSR.</p>
<h2 id="pre-rendering-of-components">Pre-rendering of components</h2>
<p>It is worth noting that pre-rendering is supported by default in Blazor Web apps. Entire pages including embedded interactive components will be rendered statically on the first request.</p>
<p>You have to take pre-rendering into account while writing code for initializing components - especially for interactive client components that will run in WebAssembly, since they will be pre-rendered in the server context.</p>
<p>A way to persist component state across pre-rendering and Blazor WebAssembly apps is still in the works.</p>
<h2 id="what-about-the-single-project-model">What about the Single-project model?</h2>
<p>Microsoft did announce quite early that they were seeking to try out a single-project model that would allow developers to put both server code and client code targeting WebAssembly in one project. This was in fact part of the proof-of-concept.</p>
<p>But after presenting the alternative ways of implementing this to the community, who voiced their opinions, it was decided to not pursue the single-project model for ASP.NET Core 8. It was simply because a majority of community members did not think that the developer experience would be that great.</p>
<p>So instead Blazor will follow the well-established project dependency pattern: Blazor Web app will have a separate project for the Client WebAssembly stuff, but the server project can reference and utilize those components. This is way more familiar to developers.</p>
<h2 id="when-should-you-use-blazor-web-app">When should you use Blazor Web app?</h2>
<p>You might consider Blazor Web app when...</p>
<ul>
<li><p>You have an app that largely runs on the server</p>
</li>
<li><p>Your app serve pages with content - being a CMS, or e-commerce site.</p>
</li>
<li><p>You might have limited need for interactivity - wanting to opt-in where it is needed.</p>
</li>
<li><p>You want to use the Razor component model - over for instance, MVC Razor Pages.</p>
</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>With these enhancements that are coming to ASP.NET Core 8, Blazor on the server will be fully integrated into ASP.NET Core - enabling mixed server-side rendered and interactive experiences for the future to come.</p>
<p>Check out the new "Blazor Web App" template in .NET 8 Previews or the upcoming RC 1.</p>
<h2 id="and-let-me-know">And let me know</h2>
<p><strong>Are you excited for what is coming to Blazor in ASP.NET Core 8? Do you still prefer MVC Razor Pages over Blazor?</strong></p>
<div style="margin-top: 42px;"><div id="disqus_thread"></div></div></div></article></main>

  <footer class="pt-3 pb-3 px-4 my-5 mx-auto w-100 container text-center"><small class="text-muted">© 2023 Marina Sundström | Built with .NET & Blazor - Hosted by GitHub Pages</small></footer></div>
        



</div>
<!-- %%-PRERENDERING-END-%% -->
</div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">🗙</a>
    </div>
    
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="_content/Blazor-Analytics/blazor-analytics.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
  


</body></html>